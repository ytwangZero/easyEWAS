MethyPath = "D:/R/Rwork/Rhistory/shiny/testdata/methydata.xlsx"
res <- initEWAS(outpath = outpath)
res <- loadEWAS(input = res, ExpoPath =  ExpoPath, MethyPath = MethyPath)
res$Data$Expo
Vars = "sex,batch"
res <- transEWAS(res, Vars = Vars, TypeTo = "factor")
adjustVar = "sex,age"
batch = "batch"
plot = TRUE
par.prior = TRUE
mean.only = FALSE
ref.batch = NULL
parallel = FALSE
core = NULL
colnames(res$Data$Expo)
res <- batchEWAS(input = res, adjustVar = adjustVar,
batch = "batch", parallel = F, core = 1)
res$Data$Expo
input = res
filename ="default"
model = "lm"
expo = 'age'
cov = "sex,LYMPHPER,BMI"
random = NULL
time = NULL
status = NULL
adjustP = TRUE
chipType = "EPICV2"
core = 6
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
library(devtools)
setwd("D:/myweb/easyEWAS") # no web
document()
# 定义 ewasfun 后立即运行
ewasfun <- function(...) {
...
}
# 查看闭包大小（调试用）
pryr::object_size(environment(ewasfun))
# ----------------------------------------------------------
# Define EWAS model fitting function based on selected model
# ----------------------------------------------------------
ewasfun <- function(cg, ff, cov) {
cov$cpg <- as.vector(t(cg))
res <- tryCatch({
if (model == "lm") {
out <- summary(lm(ff, data = cov))
unlist(lapply(2:facnum, function(i) out$coefficients[i, c(1, 2, 4)]))
} else if (model == "lmer") {
out <- summary(lmer(ff, data = cov))
unlist(lapply(2:facnum, function(i) out$coefficients[i, c(1, 2, 5)]))
} else if (model == "cox") {
out <- summary(coxph(ff, data = cov))
c(as.vector(out$conf.int[1, c(1, 3, 4)]), out$coefficients[1, 5])
} else {
stop("Unsupported model: ", model)
}
}, error = function(e) {
if (model %in% c("lm", "lmer")) return(rep(NA_real_, 3 * (facnum - 1)))
if (model == "cox") return(rep(NA_real_, 4))
})
return(res)
}
# 定义 ewasfun 后立即运行
ewasfun <- function(...) {
...
}
# 查看闭包大小（调试用）
pryr::object_size(environment(ewasfun))
source("D:/myweb/easyEWAS/R/startEWAS.R")
detach("package:easyEWAS", unload = TRUE, character.only = TRUE)
res <- startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
detach("package:easyEWAS", unload = TRUE, character.only = TRUE)
remove.packages("easyEWAS")
source("D:/myweb/easyEWAS/R/initEWAS.R")
source("D:/myweb/easyEWAS/R/loadEWAS.R")
source("D:/myweb/easyEWAS/R/transEWAS.R")
source("D:/myweb/easyEWAS/R/batchEWAS.R")
source("D:/myweb/easyEWAS/R/startEWAS.R")
library(easyEWAS)
rm(list = ls())
outpath = "D:/test"
ExpoPath = "D:/R/Rwork/Rhistory/shiny/testdata/sampledata.xlsx"
MethyPath = "D:/R/Rwork/Rhistory/shiny/testdata/methydata.xlsx"
res <- initEWAS(outpath = outpath)
res <- loadEWAS(input = res, ExpoPath =  ExpoPath, MethyPath = MethyPath)
res$Data$Expo
Vars = "sex,batch"
res <- transEWAS(res, Vars = Vars, TypeTo = "factor")
adjustVar = "sex,age"
batch = "batch"
plot = TRUE
par.prior = TRUE
mean.only = FALSE
ref.batch = NULL
parallel = FALSE
core = NULL
colnames(res$Data$Expo)
res <- batchEWAS(input = res, adjustVar = adjustVar,
batch = "batch", parallel = F, core = 1)
res$Data$Expo
input = res
filename ="default"
model = "lm"
expo = 'age'
cov = "sex,LYMPHPER,BMI"
random = NULL
source("D:/myweb/easyEWAS/R/initEWAS.R")
source("D:/myweb/easyEWAS/R/loadEWAS.R")
source("D:/myweb/easyEWAS/R/transEWAS.R")
source("D:/myweb/easyEWAS/R/batchEWAS.R")
source("D:/myweb/easyEWAS/R/startEWAS.R")
library(easyEWAS)
rm(list = ls())
outpath = "D:/test"
ExpoPath = "D:/R/Rwork/Rhistory/shiny/testdata/sampledata.xlsx"
MethyPath = "D:/R/Rwork/Rhistory/shiny/testdata/methydata.xlsx"
res <- initEWAS(outpath = outpath)
res <- loadEWAS(input = res, ExpoPath =  ExpoPath, MethyPath = MethyPath)
res$Data$Expo
Vars = "sex,batch"
rm(list = ls())
source("D:/myweb/easyEWAS/R/initEWAS.R")
source("D:/myweb/easyEWAS/R/loadEWAS.R")
source("D:/myweb/easyEWAS/R/transEWAS.R")
source("D:/myweb/easyEWAS/R/batchEWAS.R")
source("D:/myweb/easyEWAS/R/startEWAS.R")
outpath = "D:/test"
ExpoPath = "D:/R/Rwork/Rhistory/shiny/testdata/sampledata.xlsx"
MethyPath = "D:/R/Rwork/Rhistory/shiny/testdata/methydata.xlsx"
res <- initEWAS(outpath = outpath)
res <- loadEWAS(input = res, ExpoPath =  ExpoPath, MethyPath = MethyPath)
res$Data$Expo
Vars = "sex,batch"
res <- transEWAS(res, Vars = Vars, TypeTo = "factor")
adjustVar = "sex,age"
batch = "batch"
plot = TRUE
par.prior = TRUE
mean.only = FALSE
ref.batch = NULL
parallel = FALSE
core = NULL
colnames(res$Data$Expo)
res <- batchEWAS(input = res, adjustVar = adjustVar,
batch = "batch", parallel = F, core = 1)
res$Data$Expo
input = res
filename ="default"
model = "lm"
expo = 'age'
cov = "sex,LYMPHPER,BMI"
random = NULL
time = NULL
status = NULL
adjustP = TRUE
chipType = "EPICV2"
core = 6
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
res <- startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
pryr::object_size(environment(ewasfun))
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
library(easyEWAS)
remotes::install_github("ytwangZero/easyEWAS")
detach("package:easyEWAS", unload = TRUE, character.only = TRUE)
remove.packages("easyEWAS")
remotes::install_github("ytwangZero/easyEWAS")
library(easyEWAS)
rm(list = ls())
outpath = "D:/test"
ExpoPath = "D:/R/Rwork/Rhistory/shiny/testdata/sampledata.xlsx"
MethyPath = "D:/R/Rwork/Rhistory/shiny/testdata/methydata.xlsx"
res <- initEWAS(outpath = outpath)
res <- loadEWAS(input = res, ExpoPath =  ExpoPath, MethyPath = MethyPath)
res$Data$Expo
Vars = "sex,batch"
res <- transEWAS(res, Vars = Vars, TypeTo = "factor")
adjustVar = "sex,age"
batch = "batch"
plot = TRUE
par.prior = TRUE
mean.only = FALSE
ref.batch = NULL
parallel = FALSE
core = NULL
colnames(res$Data$Expo)
res <- batchEWAS(input = res, adjustVar = adjustVar,
batch = "batch", parallel = F, core = 1)
res$Data$Expo
input = res
filename ="default"
model = "lm"
expo = 'age'
cov = "sex,LYMPHPER,BMI"
random = NULL
time = NULL
status = NULL
adjustP = TRUE
chipType = "EPICV2"
core = 2
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
detach("package:easyEWAS", unload = TRUE, character.only = TRUE)
remove.packages("easyEWAS")
remotes::install_github("ytwangZero/easyEWAS")
library(easyEWAS)
rm(list = ls())
outpath = "D:/test"
ExpoPath = "D:/R/Rwork/Rhistory/shiny/testdata/sampledata.xlsx"
MethyPath = "D:/R/Rwork/Rhistory/shiny/testdata/methydata.xlsx"
res <- initEWAS(outpath = outpath)
res <- loadEWAS(input = res, ExpoPath =  ExpoPath, MethyPath = MethyPath)
res$Data$Expo
Vars = "sex,batch"
res <- transEWAS(res, Vars = Vars, TypeTo = "factor")
adjustVar = "sex,age"
batch = "batch"
plot = TRUE
par.prior = TRUE
mean.only = FALSE
ref.batch = NULL
parallel = FALSE
core = NULL
colnames(res$Data$Expo)
res <- batchEWAS(input = res, adjustVar = adjustVar,
batch = "batch", parallel = F, core = 1)
res$Data$Expo
input = res
filename ="default"
model = "lm"
expo = 'age'
cov = "sex,LYMPHPER,BMI"
random = NULL
time = NULL
status = NULL
adjustP = TRUE
chipType = "EPICV2"
core = 2
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
core = 6
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
setwd("D:/myweb/easyEWAS") # no web
load_all()
document()
detach("package:easyEWAS", unload = TRUE, character.only = TRUE)
remove.packages("easyEWAS")
remotes::install_github("ytwangZero/easyEWAS")
library(easyEWAS)
rm(list = ls())
outpath = "D:/test"
ExpoPath = "D:/R/Rwork/Rhistory/shiny/testdata/sampledata.xlsx"
MethyPath = "D:/R/Rwork/Rhistory/shiny/testdata/methydata.xlsx"
res <- initEWAS(outpath = outpath)
res <- loadEWAS(input = res, ExpoPath =  ExpoPath, MethyPath = MethyPath)
res$Data$Expo
Vars = "sex,batch"
res <- transEWAS(res, Vars = Vars, TypeTo = "factor")
adjustVar = "sex,age"
batch = "batch"
plot = TRUE
par.prior = TRUE
mean.only = FALSE
ref.batch = NULL
parallel = FALSE
core = NULL
colnames(res$Data$Expo)
res <- batchEWAS(input = res, adjustVar = adjustVar,
batch = "batch", parallel = F, core = 1)
res$Data$Expo
input = res
filename ="default"
model = "lm"
expo = 'age'
cov = "sex,LYMPHPER,BMI"
random = NULL
time = NULL
status = NULL
adjustP = TRUE
chipType = "EPICV2"
core = 6
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
detach("package:easyEWAS", unload = TRUE, character.only = TRUE)
rm(list = ls())
source("D:/myweb/easyEWAS/R/initEWAS.R")
source("D:/myweb/easyEWAS/R/loadEWAS.R")
source("D:/myweb/easyEWAS/R/transEWAS.R")
source("D:/myweb/easyEWAS/R/batchEWAS.R")
source("D:/myweb/easyEWAS/R/startEWAS.R")
outpath = "D:/test"
ExpoPath = "D:/R/Rwork/Rhistory/shiny/testdata/sampledata.xlsx"
MethyPath = "D:/R/Rwork/Rhistory/shiny/testdata/methydata.xlsx"
res <- initEWAS(outpath = outpath)
res <- loadEWAS(input = res, ExpoPath =  ExpoPath, MethyPath = MethyPath)
res$Data$Expo
Vars = "sex,batch"
res <- transEWAS(res, Vars = Vars, TypeTo = "factor")
adjustVar = "sex,age"
batch = "batch"
plot = TRUE
par.prior = TRUE
mean.only = FALSE
ref.batch = NULL
parallel = FALSE
core = NULL
colnames(res$Data$Expo)
res <- batchEWAS(input = res, adjustVar = adjustVar,
batch = "batch", parallel = F, core = 1)
res$Data$Expo
input = res
filename ="default"
model = "lm"
expo = 'age'
cov = "sex,LYMPHPER,BMI"
random = NULL
time = NULL
status = NULL
adjustP = TRUE
chipType = "EPICV2"
core = 6
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
detach("package:easyEWAS", unload = TRUE, character.only = TRUE)
remove.packages("easyEWAS")
rm(list = ls())
source("D:/myweb/easyEWAS/R/initEWAS.R")
source("D:/myweb/easyEWAS/R/loadEWAS.R")
source("D:/myweb/easyEWAS/R/transEWAS.R")
source("D:/myweb/easyEWAS/R/batchEWAS.R")
source("D:/myweb/easyEWAS/R/startEWAS.R")
outpath = "D:/test"
ExpoPath = "D:/R/Rwork/Rhistory/shiny/testdata/sampledata.xlsx"
MethyPath = "D:/R/Rwork/Rhistory/shiny/testdata/methydata.xlsx"
res <- initEWAS(outpath = outpath)
res <- loadEWAS(input = res, ExpoPath =  ExpoPath, MethyPath = MethyPath)
res$Data$Expo
Vars = "sex,batch"
res <- transEWAS(res, Vars = Vars, TypeTo = "factor")
adjustVar = "sex,age"
batch = "batch"
plot = TRUE
par.prior = TRUE
mean.only = FALSE
ref.batch = NULL
parallel = FALSE
core = NULL
colnames(res$Data$Expo)
res <- batchEWAS(input = res, adjustVar = adjustVar,
batch = "batch", parallel = F, core = 1)
res$Data$Expo
input = res
filename ="default"
model = "lm"
expo = 'age'
cov = "sex,LYMPHPER,BMI"
random = NULL
time = NULL
status = NULL
adjustP = TRUE
chipType = "EPICV2"
core = 6
res <- easyEWAS::startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
res <- startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
source("D:/myweb/easyEWAS/R/ewasfun_utlils.R")
source("D:/myweb/easyEWAS/R/ewasfun_utils.R")
res <- startEWAS(res,
filename =filename,
model = model,
expo = expo,
cov = cov,
random = random,
time = time,
status = status,
adjustP = adjustP,
chipType = chipType,
core = core)
setwd("D:/myweb/easyEWAS") # no web
load_all()
document()
remove.packages("easyEWAS")
detach("package:easyEWAS", unload = TRUE, character.only = TRUE)
setwd("D:/myweb/easyEWAS") # no web
load_all()
document()
